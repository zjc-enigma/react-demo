<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-06-08 Thu 14:57 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>创意文案项目交接文档</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="jiancheng.zhai@ipinyou.com" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">创意文案项目交接文档</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgfc038fe">1. 项目说明</a>
<ul>
<li><a href="#orgbfa7fed">1.1. 概述</a></li>
<li><a href="#orged33570">1.2. 目的</a></li>
<li><a href="#orgd46c4fc">1.3. 意义</a></li>
<li><a href="#org5d47940">1.4. 必要性</a></li>
<li><a href="#orgefa6411">1.5. 产出</a></li>
</ul>
</li>
<li><a href="#org442f2b6">2. 项目功能</a>
<ul>
<li><a href="#org9452590">2.1. 产品设计</a>
<ul>
<li><a href="#org487a36a">2.1.1. 原型</a></li>
<li><a href="#orgc815d45">2.1.2. 主要功能</a></li>
<li><a href="#orga29f7ed">2.1.3. 文案采集</a></li>
<li><a href="#org8558553">2.1.4. 文案挖掘</a></li>
<li><a href="#org3099b06">2.1.5. 文案检索</a></li>
<li><a href="#orgd822242">2.1.6. 文案编辑</a></li>
<li><a href="#org2465be6">2.1.7. 文案生成</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org437fe36">3. 技术路线</a>
<ul>
<li><a href="#orgad1f1c5">3.1. 依赖环境</a>
<ul>
<li><a href="#orge7dafe1">3.1.1. python</a></li>
<li><a href="#org019b512">3.1.2. nginx</a></li>
<li><a href="#orga3fd596">3.1.3. react</a></li>
<li><a href="#org5b3cf8d">3.1.4. postgresql</a></li>
<li><a href="#orgbe19ba4">3.1.5. docker</a></li>
</ul>
</li>
<li><a href="#orged2c11c">3.2. 前端</a>
<ul>
<li><a href="#org64984d4">3.2.1. 页面组件</a></li>
<li><a href="#org1790010">3.2.2. 路由</a></li>
<li><a href="#org41b26a0">3.2.3. 数据流管理</a></li>
<li><a href="#org32ded59">3.2.4. 页面布局</a></li>
</ul>
</li>
<li><a href="#org17bf2db">3.3. 后端</a>
<ul>
<li><a href="#org113e539">3.3.1. 数据采集</a></li>
<li><a href="#org0fd8b6b">3.3.2. 文本挖掘</a></li>
<li><a href="#org5ca78e4">3.3.3. 数据库管理</a></li>
<li><a href="#org3bfc553">3.3.4. web 服务</a></li>
</ul>
</li>
<li><a href="#org0c6c9c4">3.4. 部署</a>
<ul>
<li><a href="#org33a21cb">3.4.1. 方案 A</a></li>
<li><a href="#org8a1d164">3.4.2. 方案 B</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org5bc60f5">4. 项目规划</a>
<ul>
<li><a href="#org6f284de">4.1. 产品设计</a></li>
<li><a href="#org3a4223f">4.2. 人力分配</a></li>
<li><a href="#orgc41cd69">4.3. 测试验证</a></li>
</ul>
</li>
<li><a href="#org8400c80">5. 数据处理</a>
<ul>
<li><a href="#orgea3be78">5.1. 数据来源</a></li>
<li><a href="#org7fe191d">5.2. 文体规则</a></li>
<li><a href="#org6e8d50f">5.3. 展现</a></li>
</ul>
</li>
<li><a href="#org5604268">6. 后端</a>
<ul>
<li><a href="#org243554b">6.1. 主要 API 接口说明</a>
<ul>
<li><a href="#org94b133f">6.1.1. /simwords</a></li>
<li><a href="#orge18c74d">6.1.2. /rand_titles</a></li>
<li><a href="#org7f6f4bd">6.1.3. /save_to_csv</a></li>
<li><a href="#orgf401f79">6.1.4. /query</a></li>
<li><a href="#orgbf67ed9">6.1.5. /query_by_class</a></li>
<li><a href="#org0eb87e3">6.1.6. /all_word_list</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org0dffb90">7. 前端</a>
<ul>
<li><a href="#org80bf5f4">7.1. 环境</a></li>
<li><a href="#org68f2079">7.2. 框架</a></li>
<li><a href="#orgbbfa3ba">7.3. UI 设计</a></li>
<li><a href="#orgbc5b68e">7.4. 页面布局</a></li>
<li><a href="#org1cc9019">7.5. 文本编辑</a></li>
</ul>
</li>
<li><a href="#orgab58246">8. 代码结构</a>
<ul>
<li><a href="#org51f62c5">8.1. 目录结构</a></li>
<li><a href="#orgd7a80eb">8.2. app 目录</a>
<ul>
<li><a href="#org14368c6">8.2.1. actions</a></li>
<li><a href="#orgebaa43d">8.2.2. components</a></li>
<li><a href="#orgfbc2775">8.2.3. containers</a></li>
<li><a href="#orgf686d26">8.2.4. css</a></li>
<li><a href="#orgabe11f1">8.2.5. reducers</a></li>
</ul>
</li>
<li><a href="#org8d344a8">8.3. bin 目录</a></li>
<li><a href="#orgd87f255">8.4. doc 目录</a></li>
<li><a href="#orgda8ca15">8.5. lib 目录</a></li>
<li><a href="#org63f3673">8.6. static 目录</a></li>
<li><a href="#org700745a">8.7. templates</a></li>
</ul>
</li>
<li><a href="#orgf6dff9f">9. 部署</a>
<ul>
<li><a href="#orgf4b1dba">9.1. docker 打包</a></li>
<li><a href="#org35e3e4d">9.2. docker 部署流程</a></li>
<li><a href="#org8fda435">9.3. 外网访问</a></li>
<li><a href="#org9169ef0">9.4. 当前线上地址</a></li>
</ul>
</li>
<li><a href="#orga1abf61">10. 后续改进点</a></li>
</ul>
</div>
</div>


<div id="outline-container-orgfc038fe" class="outline-2">
<h2 id="orgfc038fe"><span class="section-number-2">1</span> 项目说明</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-orgbfa7fed" class="outline-3">
<h3 id="orgbfa7fed"><span class="section-number-3">1.1</span> 概述</h3>
<div class="outline-text-3" id="text-1-1">
<p>
一个自动抓取并生成创意文案的工具, 可供创意制作人员参考，后期可以通过机器学习自动化生产广告创意
</p>
</div>
</div>
<div id="outline-container-orged33570" class="outline-3">
<h3 id="orged33570"><span class="section-number-3">1.2</span> 目的</h3>
</div>
<div id="outline-container-orgd46c4fc" class="outline-3">
<h3 id="orgd46c4fc"><span class="section-number-3">1.3</span> 意义</h3>
</div>
<div id="outline-container-org5d47940" class="outline-3">
<h3 id="org5d47940"><span class="section-number-3">1.4</span> 必要性</h3>
</div>
<div id="outline-container-orgefa6411" class="outline-3">
<h3 id="orgefa6411"><span class="section-number-3">1.5</span> 产出</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li>自动化批量产出优质创意, 包括创意文案和创意图像, 可用于线上投放</li>
<li>从网络收集大量优质语料, 汇总成一个 Web 产品, 供人工检索和参考</li>
<li>分析现有创意图像的投放效果, 产出影响创意图像的投放效果分析报告, 自动化产生创意图像组合</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-org442f2b6" class="outline-2">
<h2 id="org442f2b6"><span class="section-number-2">2</span> 项目功能</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-org9452590" class="outline-3">
<h3 id="org9452590"><span class="section-number-3">2.1</span> 产品设计</h3>
<div class="outline-text-3" id="text-2-1">
</div><div id="outline-container-org487a36a" class="outline-4">
<h4 id="org487a36a"><span class="section-number-4">2.1.1</span> 原型</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
参考 <a href="http://thebestspinner.com/">http://thebestspinner.com/</a>
</p>
</div>
</div>
<div id="outline-container-orgc815d45" class="outline-4">
<h4 id="orgc815d45"><span class="section-number-4">2.1.2</span> 主要功能</h4>
<div class="outline-text-4" id="text-2-1-2">
</div><ol class="org-ol"><li><a id="org35d9da5"></a>文案采集<br /></li>
<li><a id="orgce2d44d"></a>文案挖掘<br /></li>
<li><a id="orgeb823b9"></a>文案检索<br /></li>
<li><a id="org4c8d2d1"></a>文案编辑<br /></li>
<li><a id="org024ae59"></a>文案生成<br /></li></ol>
</div>

<div id="outline-container-orga29f7ed" class="outline-4">
<h4 id="orga29f7ed"><span class="section-number-4">2.1.3</span> 文案采集</h4>
<div class="outline-text-4" id="text-2-1-3">
</div><ol class="org-ol"><li><a id="org8f63031"></a>技术点<br /><ol class="org-ol"><li><a id="org8ec1d73"></a>自动化采集广告文案<br /><div class="outline-text-6" id="text-2-1-3-1-1">
<p>
就整个互联网环境来说，广告文案并不是一种丰富的资源，而且流行的文案会随着时间不断发生变化，因此必须不断通过互联网获取新文案资源。本项目中文案来源是一些投放广告较多的优质媒体，例如今日头条。采集这些媒体上的广告文案资源使用了以下技术手段，基于 python3 的异步模块 asycio 编写异步爬虫模拟浏览器，对包含文案的页面进行访问，获取返回结果后，使用 python 的 html 解析库 pyQuery 针对特定媒体的页面数据结构，进行文案信息提取。将采集的结果作为文案清洗模块的输入。
</p>
</div></li>
<li><a id="orgc504243"></a>自动代理切换<br /><div class="outline-text-6" id="text-2-1-3-1-2">
<p>
大多数媒体网站，都会对同一 ip 的访问进行限制，当请求超过阈值后会封锁该 ip。因此，进行大规模文案采集时，需要根据情况建立一个代理池，并自动切换池中代理对页面进行访问。本项目整合了免费代理和收费代理，共计 500 个 ip，先通过代理有效性验证模块，检测代理 ip 的有效性，然后把有效的代理 ip 加入代理池。如果在访问时某个 ip 失效次数超过阈值，则将其从代理池中清除。
</p>
</div></li>
<li><a id="org6b8b6eb"></a>分布式并行采集<br /><div class="outline-text-6" id="text-2-1-3-1-3">
<p>
使用 redis 作为消息队列，在多台机器上部署采集程序，这样可以极大提升采集效率，充分利用多余的机器资源。
</p>
</div></li>
<li><a id="org0196b07"></a>数据清洗，格式规范<br /><div class="outline-text-6" id="text-2-1-3-1-4">
<p>
利用正则表达式，对文案中的多余字符进行过滤和规范。
</p>
</div></li>
<li><a id="org3d87676"></a>数据结构化存储<br /><div class="outline-text-6" id="text-2-1-3-1-5">
<p>
使用 postgresql 作为文案数据库，将过滤清洗后的文案以及相关数据入库，用于后续的挖掘和分类。除了固定字段外，保留一个 JSONB 的额外信息字段，用于扩展。
</p>
</div></li></ol></li></ol>
</div>

<div id="outline-container-org8558553" class="outline-4">
<h4 id="org8558553"><span class="section-number-4">2.1.4</span> 文案挖掘</h4>
<div class="outline-text-4" id="text-2-1-4">
</div><ol class="org-ol"><li><a id="org096c1b1"></a>技术点<br /><ol class="org-ol"><li><a id="org46f3175"></a>文案分类标签<br /><div class="outline-text-6" id="text-2-1-4-1-1">
<p>
结合了类目信息数据库的规则，对每一条文案所对应的来源、行业进行标签标记，允许一条文案有多个标签。标签会出现在搜索结果页，用户可以点击标签筛选对应的文案。
</p>
</div></li>
<li><a id="orgf670f96"></a>文案文体标签<br /><div class="outline-text-6" id="text-2-1-4-1-2">
<p>
针对文案内容设置文体识别规则，一共包括独立于标签体系之外的九种文体，用户在进行文案检索时可以看到对应文体标注，方便用户识别文案的结构，是对标签体系的一种补充。
</p>
</div></li>
<li><a id="org0e9a1f2"></a>文案数据挖掘<br /><div class="outline-text-6" id="text-2-1-4-1-3">
<p>
基于采集的文案内容，文案数据挖掘模块负责执行 nlp 和机器学习算法挖掘出有价值的信息，直接或间接提供给用户使用。
</p>
</div></li>
<li><a id="org8282d0b"></a>文案相关关键词检索<br /><div class="outline-text-6" id="text-2-1-4-1-4">
<p>
根据用户选择词，访问文案数据挖掘模块，获得与该词相关性强的词列表，以及对应权重分数信息，相关性是通过计算大量语料词向量获得。用户在文案编辑界面点击获取相关词，可以看到相关词列表，点击该列表上的词可以插入到文案辅助编辑区。
</p>
</div></li>
<li><a id="orgd71c8c1"></a>文案相关行业词检索<br /><div class="outline-text-6" id="text-2-1-4-1-5">
<p>
根据用户选择的待编辑词，访问文案数据挖掘模块，获得与该词相关性强的词列表，以及对应权重分数信息，行业词列表是通过挖掘有行业标注的文案语料获得。用户在文案编辑界面点击获取相关词，可以看到相关词列表，点击该列表上的词可以插入到文案辅助编辑区。
</p>
</div></li>
<li><a id="orga7b158c"></a>文案词优质高频检索<br /><div class="outline-text-6" id="text-2-1-4-1-6">
<p>
根据用户选择的待编辑词，访问文案数据挖掘模块，获得与该词相关性强的词列表，以及对应权重分数信息，高频词是结合该文案语料在实际投放中的 CTR 获得。用户在文案编辑界面点击获取相关词，可以看到相关词列表，点击该列表上的词可以插入到文案辅助编辑区。
</p>
</div></li>
<li><a id="org83fb061"></a>相关词权重分值评估<br /><div class="outline-text-6" id="text-2-1-4-1-7">
<p>
对各类词原始权重进行分值换算，并进行归一化，使最终得分便于用户评估参考。
</p>
</div></li></ol></li></ol>
</div>
<div id="outline-container-org3099b06" class="outline-4">
<h4 id="org3099b06"><span class="section-number-4">2.1.5</span> 文案检索</h4>
<div class="outline-text-4" id="text-2-1-5">
</div><ol class="org-ol"><li><a id="org121da9b"></a>技术点<br /><ol class="org-ol"><li><a id="orgc40d239"></a>检索算法<br /><div class="outline-text-6" id="text-2-1-5-1-1">
<p>
设计了模糊查询检索算法，避免使用简单的关键词匹配，一方面避免用户因输入不当造成的结果缺失，另一方面极大加快了检索速度。
</p>
</div></li>
<li><a id="org20b1cac"></a>动态 ranking 策略<br /><div class="outline-text-6" id="text-2-1-5-1-2">
<p>
当文案数量多时，如果每次用户搜索到的结果 ranking 都完全一样，排名靠后的结果将难以被用户获知。为避免这种情况，对检索展现的结果进行动态 ranking 排序，确保符合条件的文案以动态顺序展现。
</p>
</div></li>
<li><a id="orgb397e13"></a>多次检索，文案购物车<br /><div class="outline-text-6" id="text-2-1-5-1-3">
<p>
用户进行文案检索之后，在检索结果页面可以继续进行多次检索，每次检索后选取的文案结果，都可以保存到临时的“文案购物车中”，这样在一次搜索中无法完全覆盖问题时，可以通过多次检索添加所有满足需求的文案到购物车，然后统一进行编辑。
</p>
</div></li></ol></li></ol>
</div>

<div id="outline-container-orgd822242" class="outline-4">
<h4 id="orgd822242"><span class="section-number-4">2.1.6</span> 文案编辑</h4>
<div class="outline-text-4" id="text-2-1-6">
</div><ol class="org-ol"><li><a id="org30988bb"></a>技术点<br /><ol class="org-ol"><li><a id="org9d4e215"></a>主编辑区<br /><div class="outline-text-6" id="text-2-1-6-1-1">
<p>
用户点击文案检索时选择保存的文案结果，可以把文案添加到主编辑区。在主编辑区内既可以直接编辑，也可以通过辅助编辑区进行关键词替换等功能。最终生成的文案结果以主编辑区为准。
</p>
</div></li>
<li><a id="orgeefde27"></a>辅助编辑区<br /><div class="outline-text-6" id="text-2-1-6-1-2">
<p>
用户点击相关词列表中的词，可以把对应词添加到辅助编辑区内。辅助编辑区对应“组合”与“连续”两种功能。组合是使用选择的多个关键词的所有组合替换用户选择的关键词，连续是用辅助编辑区内的文本直接替换用户选择的关键词。
</p>
</div></li></ol></li></ol>
</div>

<div id="outline-container-org2465be6" class="outline-4">
<h4 id="org2465be6"><span class="section-number-4">2.1.7</span> 文案生成</h4>
<div class="outline-text-4" id="text-2-1-7">
</div><ol class="org-ol"><li><a id="orgbd9992e"></a>技术点<br /><ol class="org-ol"><li><a id="orgd5b5c63"></a>文案结果导出<br /><div class="outline-text-6" id="text-2-1-7-1-1">
<p>
用户在编辑结束后，点击导出按钮，可以进入文案导出页面，该页面包含最终生成的文案结果预览。用户选择一个或多个需要保存的文案后，点击保存，对应文案会生成一个结果文件下载到用户本地。
</p>
</div></li></ol></li></ol>
</div>
</div>
</div>


<div id="outline-container-org437fe36" class="outline-2">
<h2 id="org437fe36"><span class="section-number-2">3</span> 技术路线</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-orgad1f1c5" class="outline-3">
<h3 id="orgad1f1c5"><span class="section-number-3">3.1</span> 依赖环境</h3>
<div class="outline-text-3" id="text-3-1">
</div><div id="outline-container-orge7dafe1" class="outline-4">
<h4 id="orge7dafe1"><span class="section-number-4">3.1.1</span> python</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
版本 3.5.2
</p>
</div>
<ol class="org-ol"><li><a id="org25f5267"></a>库<br /><div class="outline-text-5" id="text-3-1-1-1">
<ul class="org-ul">
<li>flask</li>
<li>sqlalchemy</li>
<li>gensim</li>
<li>nltk</li>
<li>gunicorn</li>
</ul>
</div></li></ol>
</div>
<div id="outline-container-org019b512" class="outline-4">
<h4 id="org019b512"><span class="section-number-4">3.1.2</span> nginx</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
版本 1.10
</p>
</div>
</div>
<div id="outline-container-orga3fd596" class="outline-4">
<h4 id="orga3fd596"><span class="section-number-4">3.1.3</span> react</h4>
<div class="outline-text-4" id="text-3-1-3">
<p>
版本 15.4.1
</p>
</div>
<ol class="org-ol"><li><a id="org15b1982"></a>库<br /><div class="outline-text-5" id="text-3-1-3-1">
<ul class="org-ul">
<li>react-router</li>
<li>redux</li>
</ul>
</div></li></ol>
</div>

<div id="outline-container-org5b3cf8d" class="outline-4">
<h4 id="org5b3cf8d"><span class="section-number-4">3.1.4</span> postgresql</h4>
<div class="outline-text-4" id="text-3-1-4">
<p>
版本 9.5.2
</p>
</div>
</div>

<div id="outline-container-orgbe19ba4" class="outline-4">
<h4 id="orgbe19ba4"><span class="section-number-4">3.1.5</span> docker</h4>
<div class="outline-text-4" id="text-3-1-5">
<p>
版本 1.13.1
</p>
</div>
</div>
</div>

<div id="outline-container-orged2c11c" class="outline-3">
<h3 id="orged2c11c"><span class="section-number-3">3.2</span> 前端</h3>
<div class="outline-text-3" id="text-3-2">
<p>
前端包含了页面组件、前端路由、数据流管理、页面布局 共 4 个模块，主要基于 react 框架，配合 npm 和 webpack 实现。
</p>
</div>

<div id="outline-container-org64984d4" class="outline-4">
<h4 id="org64984d4"><span class="section-number-4">3.2.1</span> 页面组件</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
页面按钮、表格文本框等组件都是基于 react 实现。使用 draftjs 富文本编辑器框架，实现项目中的主编辑区和辅助编辑区。整体页面风格采用了基于 react 的 material-ui，实现了协调的 material design 风格页面。前端所有依赖的包和扩展都是通过 npm 进行统一管理和控制，提高了可维护性和可移植性。用于对 css、js、jpeg、png 等资源进行统一编译和打包。
</p>
</div>
</div>
<div id="outline-container-org1790010" class="outline-4">
<h4 id="org1790010"><span class="section-number-4">3.2.2</span> 路由</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
采用 react-router 作为路由组件，对文案检索，文案选择，文案编辑，文案导出 4 个页面进行路由管理。
</p>
</div>
</div>
<div id="outline-container-org41b26a0" class="outline-4">
<h4 id="org41b26a0"><span class="section-number-4">3.2.3</span> 数据流管理</h4>
<div class="outline-text-4" id="text-3-2-3">
<p>
使用 redux 对 react 组件进行数据流管理，确保每个组件都严格按照单向数据流要求进行设计和实现。
</p>
</div>
</div>

<div id="outline-container-org32ded59" class="outline-4">
<h4 id="org32ded59"><span class="section-number-4">3.2.4</span> 页面布局</h4>
<div class="outline-text-4" id="text-3-2-4">
<p>
没有采用 react 组件的形式进行页面布局控制，而是采用了相对灵活的 flex 布局，使用 scss 文件对布局进行改写和调整，再由 webpack 打包成 css 文件进行页面渲染。
</p>
</div>
</div>
</div>

<div id="outline-container-org17bf2db" class="outline-3">
<h3 id="org17bf2db"><span class="section-number-3">3.3</span> 后端</h3>
<div class="outline-text-3" id="text-3-3">
<p>
后端分为数据采集、文本挖掘、数据库管理、web 服务共 4 个模块。
</p>
</div>

<div id="outline-container-org113e539" class="outline-4">
<h4 id="org113e539"><span class="section-number-4">3.3.1</span> 数据采集</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
基于 python 实现了多个媒体的大规模爬虫，使用了 python 的异步框架提高性能，使用 redis 对爬虫任务进行分布式管理。数据采集模块得到的数据写入数据库进行统一管理和使用。
</p>
</div>
</div>
<div id="outline-container-org0fd8b6b" class="outline-4">
<h4 id="org0fd8b6b"><span class="section-number-4">3.3.2</span> 文本挖掘</h4>
<div class="outline-text-4" id="text-3-3-2">
<p>
基于 python 的 nltk、gensim、pynlpir 实现。
</p>
</div>
</div>
<div id="outline-container-org5ca78e4" class="outline-4">
<h4 id="org5ca78e4"><span class="section-number-4">3.3.3</span> 数据库管理</h4>
<div class="outline-text-4" id="text-3-3-3">
<p>
采用 postgresql 数据库进行数据存储，使用 alembic 进行数据库管理，使用 sqlalchmey 实现数据库 orm 操作。
</p>
</div>
</div>
<div id="outline-container-org3bfc553" class="outline-4">
<h4 id="org3bfc553"><span class="section-number-4">3.3.4</span> web 服务</h4>
<div class="outline-text-4" id="text-3-3-4">
<p>
采用 flask 作为后端框架，使用 flask_restful 实现 restful api。
</p>
</div>
</div>
</div>


<div id="outline-container-org0c6c9c4" class="outline-3">
<h3 id="org0c6c9c4"><span class="section-number-3">3.4</span> 部署</h3>
<div class="outline-text-3" id="text-3-4">
<p>
部署采用了两种方式
</p>
</div>
<div id="outline-container-org33a21cb" class="outline-4">
<h4 id="org33a21cb"><span class="section-number-4">3.4.1</span> 方案 A</h4>
<div class="outline-text-4" id="text-3-4-1">
<ul class="org-ul">
<li>python3.5.2</li>
<li>pip 9.0.1</li>
<li>nodejs v7.5.0</li>
<li>npm 4.1.2</li>
<li>webpack 2.2.1</li>
<li>nginx 1.10.2 以上版本，开启模块 auth_basic auth_pam auth_request cache_purge dav dav_ext fastcgi gzip map memcached proxy rewrite，配置为默认启动的系统服务</li>
<li>postgresql 9.5.5(需建表，并提供读写权限账号)</li>
</ul>
</div>
</div>
<div id="outline-container-org8a1d164" class="outline-4">
<h4 id="org8a1d164"><span class="section-number-4">3.4.2</span> 方案 B</h4>
<div class="outline-text-4" id="text-3-4-2">
<ul class="org-ul">
<li>采用 docker 部署</li>
</ul>
</div>
</div>
</div>
</div>



<div id="outline-container-org5bc60f5" class="outline-2">
<h2 id="org5bc60f5"><span class="section-number-2">4</span> 项目规划</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-org6f284de" class="outline-3">
<h3 id="org6f284de"><span class="section-number-3">4.1</span> 产品设计</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>原型参考  <a href="http://thebestspinner.com/">http://thebestspinner.com/</a></li>
<li>核心功能 1: 根据抓取的高质量文案, 训练机器学习模型, 通过算法生成优质文案, 可直接用于投放</li>
<li>核心功能 2: 根据已有文案模板中的关键词, 生成相关词列表, 人工筛选相关词替换该关键词, 通过多个相关词组合生成大量优质原创文案</li>
<li>核心功能 3: 根据创意图像的投放效果, 生成图像元素与投放效果之间的相关性分析, 自动生成图像元素优化组合</li>
</ul>
</div>
</div>

<div id="outline-container-org3a4223f" class="outline-3">
<h3 id="org3a4223f"><span class="section-number-3">4.2</span> 人力分配</h3>
<div class="outline-text-3" id="text-4-2">
<ul class="org-ul">
<li>产品人力 1</li>
<li>前端人力 1</li>
<li>算法人力 1.5</li>
</ul>
</div>
</div>

<div id="outline-container-orgc41cd69" class="outline-3">
<h3 id="orgc41cd69"><span class="section-number-3">4.3</span> 测试验证</h3>
<div class="outline-text-3" id="text-4-3">
<ul class="org-ul">
<li>人工评审: 随机给出机器文案和语料文案, 有人工判断哪个出自机器, 如果不易判断, 表示机器文案质量高</li>
<li>线上测试: 根据特定广告批量产出文案用于投放, 根据实际投放结果筛选出高质量的文案模板</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-org8400c80" class="outline-2">
<h2 id="org8400c80"><span class="section-number-2">5</span> 数据处理</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-orgea3be78" class="outline-3">
<h3 id="orgea3be78"><span class="section-number-3">5.1</span> 数据来源</h3>
<div class="outline-text-3" id="text-5-1">
<p>
使用爬虫获取今日头条部分广告标题和新闻标题
</p>
</div>
</div>
<div id="outline-container-org7fe191d" class="outline-3">
<h3 id="org7fe191d"><span class="section-number-3">5.2</span> 文体规则</h3>
<div class="outline-text-3" id="text-5-2">
<p>
将所有标题根据文案特点分为以下文体, 通过正则匹配归类
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">文体名</th>
<th scope="col" class="org-left">匹配规则</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">如何体</td>
<td class="org-left">如何,怎样,怎么,何以,知道</td>
</tr>

<tr>
<td class="org-left">揭秘体</td>
<td class="org-left">揭秘,爆料,劲爆,内幕,真相,隐情</td>
</tr>

<tr>
<td class="org-left">夸张体</td>
<td class="org-left">惊,紧急,十万火急,吓一跳,围观,竟然,原来,不可思议,疯转,疯了</td>
</tr>

<tr>
<td class="org-left">否定体</td>
<td class="org-left">落伍,亏大了,甩几条街,不是</td>
</tr>

<tr>
<td class="org-left">符号体</td>
<td class="org-left">［,｛,[,{,？,！,?,!</td>
</tr>

<tr>
<td class="org-left">归纳体</td>
<td class="org-left">盘点,合集,都在这里,大全,总览</td>
</tr>

<tr>
<td class="org-left">福利体</td>
<td class="org-left">赚大了,赠送,红包,惊呼,给力,快抢,疯抢,免费,便宜,包邮,折扣,降价,优惠,送礼,返现</td>
</tr>

<tr>
<td class="org-left">消息体</td>
<td class="org-left">好消息,大消息,今日消息,最新消息,新政出台,HOT,关注,热点,重磅消息</td>
</tr>

<tr>
<td class="org-left">人性体</td>
<td class="org-left">美女,美色,偷窥,私密,占便宜</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org6e8d50f" class="outline-3">
<h3 id="org6e8d50f"><span class="section-number-3">5.3</span> 展现</h3>
<div class="outline-text-3" id="text-5-3">
<p>
对每一类文体标题, 每次刷新页面时随机选取 10 条进行展现
</p>
</div>
</div>
</div>


<div id="outline-container-org5604268" class="outline-2">
<h2 id="org5604268"><span class="section-number-2">6</span> 后端</h2>
<div class="outline-text-2" id="text-6">
</div><div id="outline-container-org243554b" class="outline-3">
<h3 id="org243554b"><span class="section-number-3">6.1</span> 主要 API 接口说明</h3>
<div class="outline-text-3" id="text-6-1">
</div><div id="outline-container-org94b133f" class="outline-4">
<h4 id="org94b133f"><span class="section-number-4">6.1.1</span> /simwords</h4>
<div class="outline-text-4" id="text-6-1-1">
</div><ol class="org-ol"><li><a id="org3f6ec46"></a>使用方法<br /><div class="outline-text-5" id="text-6-1-1-1">
<ul class="org-ul">
<li>输入：POST 其中 base_word 项对应要查询的相似词</li>
<li>输出：返回 base_word 的相似词列表</li>
</ul>
</div></li></ol>
</div>
<div id="outline-container-orge18c74d" class="outline-4">
<h4 id="orge18c74d"><span class="section-number-4">6.1.2</span> /rand_titles</h4>
<div class="outline-text-4" id="text-6-1-2">
</div><ol class="org-ol"><li><a id="org3a80abf"></a>使用方法<br /><div class="outline-text-5" id="text-6-1-2-1">
<ul class="org-ul">
<li>输入：GET</li>
<li>输出：随机从语料库中返回 10 个 title</li>
</ul>
</div></li></ol>
</div>

<div id="outline-container-org7f6f4bd" class="outline-4">
<h4 id="org7f6f4bd"><span class="section-number-4">6.1.3</span> /save_to_csv</h4>
<div class="outline-text-4" id="text-6-1-3">
</div><ol class="org-ol"><li><a id="orgaef1704"></a>使用方法<br /><div class="outline-text-5" id="text-6-1-3-1">
<ul class="org-ul">
<li>输入：POST 修改完成后的文案</li>
<li>输出：返回文案的 csv 文档</li>
</ul>
</div></li></ol>
</div>

<div id="outline-container-orgf401f79" class="outline-4">
<h4 id="orgf401f79"><span class="section-number-4">6.1.4</span> /query</h4>
<div class="outline-text-4" id="text-6-1-4">
</div><ol class="org-ol"><li><a id="org1b633af"></a>使用方法<br /><div class="outline-text-5" id="text-6-1-4-1">
<ul class="org-ul">
<li>输入：POST 一个用户输入的关键词</li>
<li>输出：返回匹配该关键词的所有文案结果</li>
</ul>
</div></li></ol>
</div>


<div id="outline-container-orgbf67ed9" class="outline-4">
<h4 id="orgbf67ed9"><span class="section-number-4">6.1.5</span> /query_by_class</h4>
<div class="outline-text-4" id="text-6-1-5">
</div><ol class="org-ol"><li><a id="org530f913"></a>使用方法<br /><div class="outline-text-5" id="text-6-1-5-1">
<ul class="org-ul">
<li>输入：POST 一个用户输入的关键词, 和一个分类名称</li>
<li>输出：返回同时匹配关键词和分类名称的文案结果</li>
</ul>
</div></li></ol>
</div>

<div id="outline-container-org0eb87e3" class="outline-4">
<h4 id="org0eb87e3"><span class="section-number-4">6.1.6</span> /all_word_list</h4>
<div class="outline-text-4" id="text-6-1-6">
</div><ol class="org-ol"><li><a id="orge30d14c"></a>使用方法<br /><div class="outline-text-5" id="text-6-1-6-1">
<ul class="org-ul">
<li>输入：POST 一个关键词</li>
<li>输出：返回三种不同类别的相似词列表, 其中 sim 对应相似词列表, important 对 CTR 重要性排序的词列表, industry 对应行业词列表</li>
</ul>
</div></li></ol>
</div>
</div>
</div>


<div id="outline-container-org0dffb90" class="outline-2">
<h2 id="org0dffb90"><span class="section-number-2">7</span> 前端</h2>
<div class="outline-text-2" id="text-7">
</div><div id="outline-container-org80bf5f4" class="outline-3">
<h3 id="org80bf5f4"><span class="section-number-3">7.1</span> 环境</h3>
<div class="outline-text-3" id="text-7-1">
<ul class="org-ul">
<li>npm3</li>
<li>webpack2</li>
<li>通过 babel 支持 es6</li>
<li>使用 redux-devtools 进行调试</li>
</ul>
</div>
</div>

<div id="outline-container-org68f2079" class="outline-3">
<h3 id="org68f2079"><span class="section-number-3">7.2</span> 框架</h3>
<div class="outline-text-3" id="text-7-2">
<p>
react + redux + react-router
</p>
</div>
</div>
<div id="outline-container-orgbbfa3ba" class="outline-3">
<h3 id="orgbbfa3ba"><span class="section-number-3">7.3</span> UI 设计</h3>
<div class="outline-text-3" id="text-7-3">
<p>
material-ui
</p>
</div>
</div>
<div id="outline-container-orgbc5b68e" class="outline-3">
<h3 id="orgbc5b68e"><span class="section-number-3">7.4</span> 页面布局</h3>
<div class="outline-text-3" id="text-7-4">
<p>
flex
</p>
</div>
</div>
<div id="outline-container-org1cc9019" class="outline-3">
<h3 id="org1cc9019"><span class="section-number-3">7.5</span> 文本编辑</h3>
<div class="outline-text-3" id="text-7-5">
<p>
draft-js
</p>
</div>
</div>
</div>


<div id="outline-container-orgab58246" class="outline-2">
<h2 id="orgab58246"><span class="section-number-2">8</span> 代码结构</h2>
<div class="outline-text-2" id="text-8">
</div><div id="outline-container-org51f62c5" class="outline-3">
<h3 id="org51f62c5"><span class="section-number-3">8.1</span> 目录结构</h3>
<div class="outline-text-3" id="text-8-1">
<p>
<img src="ls.jpeg" alt="ls.jpeg" />
整个项目的工程目录内容如上图所示，其中 requirements.txt 是依赖的 python 库列表，可以使用 pip 获取依赖。package.json 是依赖的 nodejs 库列表，可以使用 npm 获取依赖，并生成 node_modules 目录。webpack.config.js 是 webpack 的配置文件。除此之外，目录结构如下图所示：
</p>
<div class="org-src-container">
<pre class="src src-text">&#9500;&#9472;&#9472; app
&#9474;&#160;&#160; &#9500;&#9472;&#9472; actions
&#9474;&#160;&#160; &#9500;&#9472;&#9472; components
&#9474;&#160;&#160; &#9500;&#9472;&#9472; containers
&#9474;&#160;&#160; &#9500;&#9472;&#9472; css
&#9474;&#160;&#160; &#9492;&#9472;&#9472; reducers
&#9500;&#9472;&#9472; bin
&#9500;&#9472;&#9472; data
&#9474;&#160;&#160; &#9492;&#9472;&#9472; words
&#9500;&#9472;&#9472; doc
&#9500;&#9472;&#9472; lib
&#9474;&#160;&#160; &#9500;&#9472;&#9472; mob_autotag
&#9474;&#160;&#160; &#9492;&#9472;&#9472; util
&#9500;&#9472;&#9472; static
&#9474;&#160;&#160; &#9500;&#9472;&#9472; css
&#9474;&#160;&#160; &#9492;&#9472;&#9472; js
&#9492;&#9472;&#9472; templates
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd7a80eb" class="outline-3">
<h3 id="orgd7a80eb"><span class="section-number-3">8.2</span> app 目录</h3>
<div class="outline-text-3" id="text-8-2">
<p>
<img src="appdir.png" alt="appdir.png" />
该目录主要包含 react 相关的组件，其中 index.jsx 包含了 react 组件根节点信息。routes.jsx 包含了前端 url 路由的配置信息。其各个子目录作用如下：
</p>
</div>
<div id="outline-container-org14368c6" class="outline-4">
<h4 id="org14368c6"><span class="section-number-4">8.2.1</span> actions</h4>
<div class="outline-text-4" id="text-8-2-1">
<p>
redux 中的组件 action 逻辑目录，目前尚未分离这部分逻辑，空置。
</p>
</div>
</div>
<div id="outline-container-orgebaa43d" class="outline-4">
<h4 id="orgebaa43d"><span class="section-number-4">8.2.2</span> components</h4>
<div class="outline-text-4" id="text-8-2-2">
<p>
<img src="componentsdir.png" alt="componentsdir.png" />
react 的组件目录。Search.jsx 对应文案搜索页面。Writer.jsx 对应文案编辑页面。Selection.jsx 对应文案选择页面。Generate.jsx 对应文案生成界面。
</p>
</div>
</div>

<div id="outline-container-orgfbc2775" class="outline-4">
<h4 id="orgfbc2775"><span class="section-number-4">8.2.3</span> containers</h4>
<div class="outline-text-4" id="text-8-2-3">
<p>
重构用，目前空置。
</p>
</div>
</div>
<div id="outline-container-orgf686d26" class="outline-4">
<h4 id="orgf686d26"><span class="section-number-4">8.2.4</span> css</h4>
<div class="outline-text-4" id="text-8-2-4">
<p>
flex 布局的 css 目录。包含各个页面的 layout 设置。
<img src="cssdir.png" alt="cssdir.png" />
</p>
</div>
</div>
<div id="outline-container-orgabe11f1" class="outline-4">
<h4 id="orgabe11f1"><span class="section-number-4">8.2.5</span> reducers</h4>
<div class="outline-text-4" id="text-8-2-5">
<p>
<img src="reducersdir.png" alt="reducersdir.png" />
redux 的 reducer 目录。index.js 为各个 reducer 的汇总。search.js 对应搜索, selection.js 对应文案选择，writer.js 对应文案编辑，generate.js 对应文案生成。
</p>
</div>
</div>
</div>

<div id="outline-container-org8d344a8" class="outline-3">
<h3 id="org8d344a8"><span class="section-number-3">8.3</span> bin 目录</h3>
<div class="outline-text-3" id="text-8-3">
<p>
flask 后端目录。其中 run.py 是整个项目的启动入口。
</p>
</div>
</div>
<div id="outline-container-orgd87f255" class="outline-3">
<h3 id="orgd87f255"><span class="section-number-3">8.4</span> doc 目录</h3>
<div class="outline-text-3" id="text-8-4">
<p>
项目说明文档目录。
</p>
</div>
</div>
<div id="outline-container-orgda8ca15" class="outline-3">
<h3 id="orgda8ca15"><span class="section-number-3">8.5</span> lib 目录</h3>
<div class="outline-text-3" id="text-8-5">
<p>
本项目依赖的一些自建库。
</p>
</div>
</div>
<div id="outline-container-org63f3673" class="outline-3">
<h3 id="org63f3673"><span class="section-number-3">8.6</span> static 目录</h3>
<div class="outline-text-3" id="text-8-6">
<p>
webpack 打包生成的静态资源。
</p>
</div>
</div>
<div id="outline-container-org700745a" class="outline-3">
<h3 id="org700745a"><span class="section-number-3">8.7</span> templates</h3>
<div class="outline-text-3" id="text-8-7">
<p>
页面模板目录。本项目使用 flask 的 jinja2 作为模板引擎。
</p>
</div>
</div>
</div>


<div id="outline-container-orgf6dff9f" class="outline-2">
<h2 id="orgf6dff9f"><span class="section-number-2">9</span> 部署</h2>
<div class="outline-text-2" id="text-9">
</div><div id="outline-container-orgf4b1dba" class="outline-3">
<h3 id="orgf4b1dba"><span class="section-number-3">9.1</span> docker 打包</h3>
<div class="outline-text-3" id="text-9-1">
<p>
目前在阿里云上的镜像仓库地址是 registry.aliyuncs.com/zjc/creative
Docker 镜像打包流程（假设已安装了 docker 环境）编写 dockerfile 参考：<a href="http://dockone.io/article/131">http://dockone.io/article/131</a>
docker 镜像提交参考：<a href="https://docs.docker.com/engine/getstarted/step_six/#step-1-tag-and-push-the-image">https://docs.docker.com/engine/getstarted/step_six/#step-1-tag-and-push-the-image</a>
</p>
<div class="org-src-container">
<pre class="src src-shell"><span class="org-comment-delimiter"># </span><span class="org-comment">&#29983;&#25104;&#38236;&#20687;</span>
docker build --tag &lt;TAG NAME&gt;  &lt;&#24453;&#25171;&#21253;&#30340;&#39033;&#30446;&#36335;&#24452;&gt;
<span class="org-comment-delimiter"># </span><span class="org-comment">&#26597;&#30475;&#38236;&#20687; ID &lt;IMAGE ID&gt;</span>
docker image
<span class="org-comment-delimiter"># </span><span class="org-comment">&lt;REPO ADDRESS&gt;&#20351;&#29992;&#20102;&#38463;&#37324;&#20113;&#30340; docker hub&#65292;&#20351;&#29992;&#21069;&#35201;&#20808;&#27880;&#20876;&#38463;&#37324;&#20113;&#24320;&#21457;&#32773;&#36134;&#21495;</span>
docker tag &lt;IMAGE ID&gt; &lt;REPO ADDRESS&gt;
docker push &lt;REPO ADDRESS&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-org35e3e4d" class="outline-3">
<h3 id="org35e3e4d"><span class="section-number-3">9.2</span> docker 部署流程</h3>
<div class="outline-text-3" id="text-9-2">
<p>
假设线上机器已经安装了 docker 环境
</p>
<div class="org-src-container">
<pre class="src src-shell"><span class="org-comment-delimiter"># </span><span class="org-comment">&#20174;&#38463;&#37324;&#20113;&#30340; docker &#20179;&#24211;&#20013; pull &#38236;&#20687;</span>
docker pull &lt;REPO ADDRESS&gt;
<span class="org-comment-delimiter"># </span><span class="org-comment">&#26597;&#30475;&#38236;&#20687; &lt;IMAGE ID&gt;</span>
docker images
<span class="org-comment-delimiter"># </span><span class="org-comment">&#24471;&#21040;&#36755;&#20986;&#22914;&#19979;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">REPOSITORY                           TAG                 IMAGE ID            CREATED             SIZE</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">registry.aliyuncs.com/zjc/creative   latest              e94b646e77f1        7 days ago          6.104 GB</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">&#21551;&#21160;&#38236;&#20687;&#65292;&#27880;&#24847;&#31471;&#21475;&#26144;&#23556;&#65292;&#22914;&#26524;&#38656;&#35201;&#20132;&#20114;&#24335;&#36816;&#34892; &#21487;&#20197;&#28155;&#21152; -it &#21442;&#25968;</span>
docker -p &lt;HOST PORT&gt;:&lt;IMAGE PORT&gt; &lt;IMAGE ID&gt;

<span class="org-comment-delimiter"># </span><span class="org-comment">&#36827;&#20837;&#19968;&#20010;&#27491;&#22312;&#36816;&#34892;&#38236;&#20687;&#20869;&#37096;&#65292;&#20027;&#35201;&#29992;&#20110;&#35843;&#35797;&#21644; debug</span>
docker attach &lt;CONTAINER ID&gt;
<span class="org-comment-delimiter"># </span><span class="org-comment">docker &#38236;&#20687;&#19982;&#23487;&#20027;&#26426;&#20114;&#30456;&#25335;&#36125;&#25991;&#20214;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">http://wiki.jikexueyuan.com/project/docker-practice/copy-the-container.html</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8fda435" class="outline-3">
<h3 id="org8fda435"><span class="section-number-3">9.3</span> 外网访问</h3>
<div class="outline-text-3" id="text-9-3">
<p>
因为机器处于 VPN 的内网网段，没有连接 VPN 时是无法访问的，需要借助工具 ngrok，阿里云主机的端口存在被屏蔽的情况，之前使用的 19999 端口无法访问，目前调整到 8000 端口
</p>
<ul class="org-ul">
<li>直接使用</li>
</ul>
<p>
进入 ngrok 目录，执行./ngrok http &lt;PORT&gt;
</p>
<ul class="org-ul">
<li>官网说明</li>
</ul>
<p>
<a href="https://ngrok.com/docs">https://ngrok.com/docs</a>
</p>
<ul class="org-ul">
<li>自己搭建 ngrok 服务</li>
</ul>
<p>
<a href="https://imququ.com/post/self-hosted-ngrokd.html">https://imququ.com/post/self-hosted-ngrokd.html</a>
</p>
</div>
</div>

<div id="outline-container-org9169ef0" class="outline-3">
<h3 id="org9169ef0"><span class="section-number-3">9.4</span> 当前线上地址</h3>
<div class="outline-text-3" id="text-9-4">
<p>
<a href="http://e18fcee5.ap.ngrok.io">http://e18fcee5.ap.ngrok.io</a>
</p>
</div>
</div>
</div>


<div id="outline-container-orga1abf61" class="outline-2">
<h2 id="orga1abf61"><span class="section-number-2">10</span> 后续改进点</h2>
<div class="outline-text-2" id="text-10">
<ul class="org-ul">
<li>利用爬虫继续收集高质量的文案语料(尤其是广告文案语料)</li>
<li>建立机器学习模型, 自动生成更多优质文案</li>
<li>根据自定义情境生成文案</li>
<li>图像处理相关</li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2016-06-06 Mon 00:00</p>
<p class="author">Author: jiancheng.zhai@ipinyou.com</p>
<p class="date">Created: 2017-06-08 Thu 14:57</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
